=== Task 15: End-to-End Integration QA ===
Date: 2026-02-22T15:20:00Z

STEP 1: Login as Alice ✅
  POST /api/v1/auth/login → 200
  User: Alice Zhang (alice@example.com)

STEP 2: Select tenant ✅
  POST /api/v1/auth/select-tenant → 200
  Tenant: Acme Corp (185425bc-1548-492f-8660-0c5c3cc35796)

STEP 3: List teams and chatgroups ✅
  GET /api/v1/teams → Engineering (0a480eed-9abb-43bf-91c1-851cd8e7ccc3)
  GET /api/v1/chatgroups → General (42a4ac6d-1e90-4332-98e5-6e7da63a392e)

STEP 4: Create robot ✅
  POST /api/v1/robots → 201
  Robot: IntegrationBot (63335ebe-ffac-42e6-b5b6-e9ab52f07a90)
  soulMd: "" (empty - Task 1 fix verified)

STEP 5: Add robot to team + chatgroup ✅
  POST /api/v1/teams/{id}/members → 201
  POST /api/v1/chatgroups/{id}/members → 201

STEP 6: Generate robot token ✅
  PUT /api/v1/robots/{id} → 200 with token
  Robot status: "onboarding"

STEP 7: Test robot config endpoint ✅
  GET /api/v1/robots/{id}/config → 200
  Response includes: robot, tenant, teams, chatgroups, config
  LLM config: null (no LLM configured for tenant - expected)

STEP 8: Per-robot SSE stream ✅
  GET /api/v1/robots/{id}/stream → SSE connection opened
  Event: connected with robotId, robotName, chatGroups

STEP 9: @mention routing ✅
  POST /api/v1/chatgroups/{id}/messages → 201
  Content: "@IntegrationBot hello, what is 2+2?"
  Robot SSE stream received: event: message with full payload
  Message includes chatGroupId, senderId, content

STEP 10: Robot POST response ✅
  POST /api/v1/robots/{id}/messages → 201
  Content: "2+2 equals 4! Happy to help."
  senderType: "robot"
  Chatgroup SSE stream received: event: message with robot response
  Sender name: "IntegrationBot", type: "robot"

STEP 11: Error cases ✅
  Wrong robot ID on config → 403 (correct)
  No token on config → 401 (correct)
  Wrong robot ID on stream → 403 (correct)
  Missing chatGroupId on POST → 400 (correct)
  Robot not member of chatgroup → 404 (correct)

STEP 12: Backward compatibility ✅
  Existing /api/v1/robots/stream → :connected (still works)
  Existing /api/v1/onboard → 200 with full config (still works)

ADDITIONAL VERIFICATIONS:
  Task 1 (soulMd optional): POST without soulMd → 201 ✅
  Task 4 (name validation): 3-word name → 400, special chars → 400, 2-word → 201 ✅

RESULT: ALL STEPS PASSED ✅
Full round-trip verified: human @mentions robot → robot receives via SSE → robot POSTs response → response appears in chatgroup stream
